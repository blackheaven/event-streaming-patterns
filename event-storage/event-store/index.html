<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Event Store - Event Streaming Patterns</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Event Store";
    var mkdocs_page_input_path = "event-storage/event-store.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Event Streaming Patterns</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Event Streaming Patterns</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Compositional patterns</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../compositional-patterns/command-query-responsibility-segregation/">Command Query Responsibility Segregation (CQRS)</a>
                </li>
                <li class="">
                    
    <a class="" href="../../compositional-patterns/event-collaboration/">Event Collaboration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../compositional-patterns/geo-replication/">Geo Replication</a>
                </li>
                <li class="">
                    
    <a class="" href="../../compositional-patterns/pipeline/">Pipeline</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Event</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../event/correlation-identifier/">Correlation Identifier</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event/event-deserializer/">Event Deserializer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event/event-envelope/">Event Envelope</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event/event-serializer/">Event Serializer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event/event-standardizer/">Event Standardizer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event/event/">Event</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event/schema-on-read/">Schema-On-Read</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Event processing</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../event-processing/claim-check/">Claim Check</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-processing/dead-letter-stream/">Dead Letter Stream</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-processing/event-chunking/">Event Chunking</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-processing/event-filter/">Event Filter</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-processing/event-mapper/">Event Mapper</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-processing/event-processing-application/">Event Processing Application</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-processing/event-processor/">Event Processor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-processing/event-router/">Event Router</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-processing/event-splitter/">Event Splitter</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-processing/event-streaming-api/">Event Streaming API</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-processing/event-translator/">Event Translator</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Event sink</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../event-sink/event-sink-connector/">Event Sink Connector</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-sink/event-sink/">Event Sink</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Event source</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../event-source/database-write-aside/">Database Write Aside</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-source/database-write-through/">Database Write Through</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-source/event-gateway/">Event Gateway</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-source/event-source-connector/">Event Source Connector</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-source/event-source/">Event Source</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-source/schema-validator/">Schema Validator</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Event storage</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../compacted-event-stream/">Compacted Event Stream</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Event Store</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#event-store">Event Store</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#problem">Problem</a></li>
        
            <li><a class="toctree-l4" href="#solution">Solution</a></li>
        
            <li><a class="toctree-l4" href="#implementation">Implementation</a></li>
        
            <li><a class="toctree-l4" href="#considerations">Considerations</a></li>
        
            <li><a class="toctree-l4" href="#references">References</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../infinite-retention-event-stream/">Infinite Retention Event Stream</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Event stream</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../event-stream/event-broker/">Event Broker</a>
                </li>
                <li class="">
                    
    <a class="" href="../../event-stream/event-stream/">Event Stream</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Stream processing</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../stream-processing/event-grouper/">Event Grouper</a>
                </li>
                <li class="">
                    
    <a class="" href="../../stream-processing/event-joiner/">Event Joiner</a>
                </li>
                <li class="">
                    
    <a class="" href="../../stream-processing/event-stream-merger/">Event Stream Merger</a>
                </li>
                <li class="">
                    
    <a class="" href="../../stream-processing/event-time-processing/">Event-Time Processing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../stream-processing/logical-and/">Logical AND</a>
                </li>
                <li class="">
                    
    <a class="" href="../../stream-processing/suppressed-event-aggregator/">Suppressed Event Aggregator</a>
                </li>
                <li class="">
                    
    <a class="" href="../../stream-processing/wait-for-n-events/">Wait for N Events</a>
                </li>
                <li class="">
                    
    <a class="" href="../../stream-processing/wallclock-time/">Wallclock-Time Processing</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Table</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../table/projection-table/">Projection Table</a>
                </li>
                <li class="">
                    
    <a class="" href="../../table/state-table/">State Table</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Event Streaming Patterns</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Event storage &raquo;</li>
        
      
    
    <li>Event Store</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="event-store">Event Store</h1>
<p>When considering an architecture based on an <a href="../event-stream/event-streaming-platform.md">Event Streaming Platform</a>, the first
fundamental question is, "How do we store our events?" This isn't as
obvious as it first sounds, as we have to consider persistence, query
performance, write throughput, availability, auditing and many other
concerns. This decision will affect all the ones that follow.</p>
<h2 id="problem">Problem</h2>
<p>How can events be stored such that they form a reliable source of
truth for applications?</p>
<h2 id="solution">Solution</h2>
<p><img alt="event store" src="../../img/event-store.svg" /></p>
<p>Incoming events are stored in an <a href="../../event-stream/event-stream/">Event Stream</a>,
implemented as an append-only log. By choosing this data structure, we
can guarantee constant-time (Θ(1)) writes, lock-free concurrent reads,
and straightforward replication across multiple machines.</p>
<h2 id="implementation">Implementation</h2>
<p>Apache Kafka® is an event store that maintains a persistent,
append-only stream — a <em>topic</em> — for each kind of event you need to
store. These topics are:</p>
<ul>
<li>Write-efficient - an append-only log is one of the fastest, cheapest
  data structures to write to.</li>
<li>Read efficient - multiple readers (cf. <a href="../../event-processing/event-processor/">Event Processor</a>) can consume the same stream without
  blocking.</li>
<li>Durable - all events are written to storage (e.g., local disk, network storage device), either synchronously (for
  maximum reliability) or asynchronously (for maximum
  throughput). Events can be as long-lived as needed, and even stored
  forever.</li>
<li>Highly-available - each event is written to multiple storage devices and replicated across multiple machines, and in
  the case of failure one of the redundant machines takes over.</li>
<li>Auditable - every change is captured and persisted. Every result can
  be traced back to its source event(s).</li>
</ul>
<h2 id="considerations">Considerations</h2>
<p>It's worth briefly contrasting Apache Kafka® with message queues and
relational databases.</p>
<p>While queues also concern themselves with a stream of events, they
often consider events as short-lived, independent messages. A
message may only exist in memory, or it may be durable enough for data
to survive server restarts, but in general they aren't intended to
hold on to events for months or even years. Further, their querying
capabilities may be limited to simple filtering, offloading more
complex queries like joins and aggregations to the application level.</p>
<p>In contrast, relational databases are very good at maintaining a
persistent state of the world in perpetuity, and answering arbitrary
questions about it, but they often fall short on <em>auditing</em> -
answering which events led up to the current state - and on
<em>liveness</em> - what <em>new</em> events do we need to consider.  They are
predominantly designed for use cases that operate on data at rest,
whereas an Event Store is designed from the ground up for data in
motion and event streaming.</p>
<p>By beginning with a fundamental data-structure for event capture, and
building on that to provide long-term persistence and arbitrary
analysis capabilities, Apache Kafka® provides an ideal choice of event
store for modern, data-driven architectures.</p>
<h2 id="references">References</h2>
<ul>
<li>See also: <a href="../../compositional-patterns/geo-replication/">Geo-Replication</a>.</li>
<li><a href="https://www.confluent.io/blog/using-logs-to-build-a-solid-data-infrastructure-or-why-dual-writes-are-a-bad-idea/">Using logs to build a solid data infrastructure</a></li>
<li><a href="https://www.confluent.io/what-is-apache-kafka/">What Is Apache Kafka?</a></li>
<li><a href="https://www.confluent.io/resources/kafka-the-definitive-guide/">Kafka: The Definitive Guide</a> free Ebook.</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../infinite-retention-event-stream/" class="btn btn-neutral float-right" title="Infinite Retention Event Stream">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../compacted-event-stream/" class="btn btn-neutral" title="Compacted Event Stream"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../compacted-event-stream/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../infinite-retention-event-stream/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
